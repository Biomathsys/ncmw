

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Community &mdash; ncmw  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hierarchical model compostion" href="hierarchical_model_composition.html" />
    <link rel="prev" title="Analysis" href="analysis.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ncmw
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Community</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Bag-of-reaction-model">Bag of reaction model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ShuttleCommunityModel">ShuttleCommunityModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Pairwise-community-interaction">Pairwise community interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Community-summary">Community summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Community-interaction">Community interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Cooperative-tradeoff">Cooperative tradeoff</a></li>
<li class="toctree-l2"><a class="reference internal" href="#COOPM">COOPM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hierarchical_model_composition.html">Hierarchical</a></li>
<li class="toctree-l1"><a class="reference internal" href="script_parameters.html">Script Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">Module Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ncmw</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Community</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/community.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Community">
<h1>Community<a class="headerlink" href="#Community" title="Permalink to this headline">¶</a></h1>
<p>Here we quickly show an example of the package applied to the some metabolic models as before. We construct some community models and demonstrate some of the available tools for analysis.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">ncmw.utils</span> <span class="k">import</span> <span class="n">get_models</span>
<span class="kn">from</span> <span class="nn">ncmw.community</span> <span class="k">import</span> <span class="n">BagOfReactionsModel</span><span class="p">,</span> <span class="n">ShuttleCommunityModel</span>
<span class="kn">from</span> <span class="nn">ncmw.setup_models</span> <span class="k">import</span> <span class="n">set_default_configs_and_snm3_medium</span>
<span class="n">models</span> <span class="o">=</span> <span class="n">get_models</span><span class="p">(</span><span class="s2">&quot;models&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)):</span>
    <span class="n">models</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">set_default_configs_and_snm3_medium</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="Bag-of-reaction-model">
<h2>Bag of reaction model<a class="headerlink" href="#Bag-of-reaction-model" title="Permalink to this headline">¶</a></h2>
<p>This very simple approach models the community as union of all reactions and metabolites of it’s members. So let’s first consider this approach:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bag_model</span> <span class="o">=</span> <span class="n">BagOfReactionsModel</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span><span class="p">,</span> <span class="n">growths</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">bag_model</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">growths</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{m.id.split(sep=&#39;_&#39;)[0]} achives </span><span class="si">{g}</span><span class="s2"> biomass rate&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CarveMe achives 0.0 biomass rate
himodel achives 0.0 biomass rate
Staphylococcus achives 7.1101761769386655 biomass rate
DP achives 0.0 biomass rate
iYS854 achives 0.0 biomass rate
</pre></div></div>
</div>
<p>Mh, so as we can see the maximum growth rate for the community is achived if Staphylooccus outcompetes all other species. This may seems unrealistic. One think we can do is to “enforce” that any member of the comunity must grow at leat 10% of the total growth rate. So lets do this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span><span class="p">,</span> <span class="n">growths</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">bag_model</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">enforce_survival</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">growths</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{m.id.split(sep=&#39;_&#39;)[0]} achives </span><span class="si">{g}</span><span class="s2"> biomass rate&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CarveMe achives 0.1306552884366914 biomass rate
himodel achives 6.010143268087804 biomass rate
Staphylococcus achives 0.1306552884366914 biomass rate
DP achives 0.1306552884366914 biomass rate
iYS854 achives 0.1306552884366914 biomass rate
</pre></div></div>
</div>
<p>Intestingly suddenly himodel achives most growth. Unforunatly with the BagOfReactions we cannot analyze the interactions more deeply. So lets look at the ShuttleCommunityModel.</p>
</div>
<div class="section" id="ShuttleCommunityModel">
<h2>ShuttleCommunityModel<a class="headerlink" href="#ShuttleCommunityModel" title="Permalink to this headline">¶</a></h2>
<p>Here any community member is seperated in own compartments, but they can interact over an external environment through so called “shuttle reactions”.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ShuttleCommunityModel</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span><span class="p">,</span> <span class="n">growths</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">growths</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{m.id.split(sep=&#39;_&#39;)[0]} achives </span><span class="si">{g}</span><span class="s2"> biomass rate&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CarveMe achives 0.051665019814527126 biomass rate
himodel achives 0.6220373234175469 biomass rate
Staphylococcus achives 0.03595262970433371 biomass rate
DP achives 0.13562384271818156 biomass rate
iYS854 achives 5.020210990276516 biomass rate
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">ncmw.visualization</span> <span class="k">import</span> <span class="n">plot_pairwise_growth_relation_per_weight</span><span class="p">,</span> <span class="n">plot_community_interaction</span><span class="p">,</span> <span class="n">plot_community_summary</span><span class="p">,</span> <span class="n">plot_community_uptake_graph</span><span class="p">,</span> <span class="n">plot_species_interaction</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Pairwise-community-interaction">
<h2>Pairwise community interaction<a class="headerlink" href="#Pairwise-community-interaction" title="Permalink to this headline">¶</a></h2>
<p>Here we plot the growth of each model, given the weight <span class="math notranslate nohighlight">\(\alpha\)</span> (and <span class="math notranslate nohighlight">\(1-\alpha\)</span> respectively). This shows e.g.&nbsp;at which weight the community is balanced between two species.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_pairwise_growth_relation_per_weight</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/community_13_0.png" src="_images/community_13_0.png" />
</div>
</div>
</div>
<div class="section" id="Community-summary">
<h2>Community summary<a class="headerlink" href="#Community-summary" title="Permalink to this headline">¶</a></h2>
<p>Lets look on the flux summary for the community. In the ShuttleCommunityModel all models have their own reactions and thus we can distinguish which metabolites are consumed/produced by which species.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">summary</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">plot_community_summary</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Objective:  5.865489805931107
CarveMe_SNM_gapfilled_model :  0.05166501981452698  with weights  1.0
himodel :  0.6220373234175482  with weights  1.0
Staphylococcus_epidermidis_ATCC_12228 :  0.03595262970433373  with weights  1.0
DP_83VPs_KB5 :  0.13562384271818173  with weights  1.0
iYS854 :  5.020210990276516  with weights  1.0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/community_15_1.png" src="_images/community_15_1.png" />
</div>
</div>
<p>This plot now actually contains most of the information. The red line shows the medium, everythink below the red line must be provide by other community members indicating a positive interaction between this species see e.g.&nbsp;EX_h20_e. That’s cool, but we can visualize it more explicitly.</p>
</div>
<div class="section" id="Community-interaction">
<h2>Community interaction<a class="headerlink" href="#Community-interaction" title="Permalink to this headline">¶</a></h2>
<p>Here we plot the internal exchanges between the community members. These show which metabolites are not provided by the medium but obtained from other community members.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plot_community_interaction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\users\manug\desktop\ncmw projects\ncmw\ncmw\community\community_analysis.py:95: FutureWarning: In a future version of pandas all arguments of DataFrame.drop except for the argument &#39;labels&#39; will be keyword-only.
  df = df.drop(df.columns[-1], 1)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/community_18_1.png" src="_images/community_18_1.png" />
</div>
</div>
<p>Equivalently we can now also illustrate which metabolites are actually taken from the medium.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span> <span class="o">=</span> <span class="n">plot_community_uptake_graph</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\Users\manug\.conda\envs\ncmw\lib\site-packages\matplotlib\cbook\__init__.py:1026: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify &#39;dtype=object&#39; when creating the ndarray.
  x = np.asanyarray(x)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/community_20_1.png" src="_images/community_20_1.png" />
</div>
</div>
<p>This may be a bit growded. So we can use this invormation to compute a “species interactions score”. By doing so we arive at following plot:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span> <span class="o">=</span> <span class="n">plot_species_interaction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/community_22_0.png" src="_images/community_22_0.png" />
</div>
</div>
<p>On this rich media, we mostly observe neutral/positive interactions. Within the workflow we also compute a COMPM, meant to induce a competitive behaviour i.e.&nbsp;by reducing the medium such that any uptake of an other species will lower the growth.</p>
</div>
<div class="section" id="Cooperative-tradeoff">
<h2>Cooperative tradeoff<a class="headerlink" href="#Cooperative-tradeoff" title="Permalink to this headline">¶</a></h2>
<p>We can see that still one of the models dominates the community. One way to obtain a more “balanced” community growth is to enable cooperative tradeoff. This will lead to a suboptimal community growth but will have a more balanced individual growth.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">summary</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">cooperative_tradeoff</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">plot_community_summary</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Objective:  2.3461959223724427
CarveMe_SNM_gapfilled_model :  0.46923918447448837  with weights  1.0
himodel :  0.4692391844744887  with weights  1.0
Staphylococcus_epidermidis_ATCC_12228 :  0.46923918447448854  with weights  1.0
DP_83VPs_KB5 :  0.46923918447448854  with weights  1.0
iYS854 :  0.46923918447448865  with weights  1.0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/community_25_1.png" src="_images/community_25_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span> <span class="o">=</span> <span class="n">plot_species_interaction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/community_26_0.png" src="_images/community_26_0.png" />
</div>
</div>
<p>Now where each model obtains the same growth, we can see some competitive interactions.</p>
</div>
<div class="section" id="COOPM">
<h2>COOPM<a class="headerlink" href="#COOPM" title="Permalink to this headline">¶</a></h2>
<p>Last but not least we may are intersted at different medias. The COOPM (cooperation inducing medium) is made such that all members in the community survive with atleast 10 % of their maximum growth rate. But also tries to minimize the number of metabolites within the medium. This induces a large number of cooperations, within the community as we see here:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">coopm</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">compute_COOPM</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">slim_optimize</span><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">medium</span> <span class="o">=</span> <span class="n">coopm</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_community_interaction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Objective:  0.5865489805634342
CarveMe_SNM_gapfilled_model :  0.30205729781699103  with weights  1.0
himodel :  0.22957169713417555  with weights  1.0
Staphylococcus_epidermidis_ATCC_12228 :  0.001155296990016737  with weights  1.0
DP_83VPs_KB5 :  0.04203370901034009  with weights  1.0
iYS854 :  0.011730979611910877  with weights  1.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\users\manug\desktop\ncmw projects\ncmw\ncmw\community\community_analysis.py:95: FutureWarning: In a future version of pandas all arguments of DataFrame.drop except for the argument &#39;labels&#39; will be keyword-only.
  df = df.drop(df.columns[-1], 1)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/community_29_2.png" src="_images/community_29_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span> <span class="o">=</span> <span class="n">plot_species_interaction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/community_30_0.png" src="_images/community_30_0.png" />
</div>
</div>
<p>Thats now much less crowded. We found a very small medium on which all community members can have growth!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">coopm</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>{&#39;EX_cl_e&#39;: 0.00526440387435687,
 &#39;EX_k_e&#39;: 0.10703127131520629,
 &#39;EX_pro__L_e&#39;: 10.0,
 &#39;EX_ca2_e&#39;: 0.004921269850081437,
 &#39;EX_mg2_e&#39;: 0.008260245659765051,
 &#39;EX_mn2_e&#39;: 0.0019649599149054796,
 &#39;EX_cobalt2_e&#39;: 0.0015384936282006924,
 &#39;EX_zn2_e&#39;: 0.0015218750158314581,
 &#39;EX_cu2_e&#39;: 0.0017507825880713728,
 &#39;EX_o2_e&#39;: 20.0,
 &#39;EX_fe2_e&#39;: 0.011078881751181213,
 &#39;EX_mobd_e&#39;: 8.21168572830355e-08,
 &#39;EX_so4_e&#39;: 0.17226740763443973,
 &#39;EX_nac_e&#39;: 0.0010105774709678883,
 &#39;EX_thm_e&#39;: 6.413671936411129e-05,
 &#39;EX_na1_e&#39;: 0.027147879335757352,
 &#39;EX_ni2_e&#39;: 0.0014919944509071798}
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hierarchical_model_composition.html" class="btn btn-neutral float-right" title="Hierarchical model compostion" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="analysis.html" class="btn btn-neutral float-left" title="Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, manuelgloeckler

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>